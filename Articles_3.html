   <!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Статья - Название статьи</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet"> <!-- Подсветка синтаксиса Prism.js -->
     <!-- Иконки для разных устройств -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">  
 <style>


        /* Основные стили */
body {
    margin: 0 auto; /* Центрирует сайт по горизонтали */
    max-width: 1400px; /* Устанавливает максимальную ширину */
    padding: 20px; /* Добавляет внутренние отступы */
    color: #FFF;
    background-color: #121212;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    box-sizing: border-box; /* Учитывает отступы и рамки в общей ширине */
}

        /* Кнопка возврата */
.back-button {
    display: inline-flex;
    align-items: center; /* Вертикальное выравнивание */
    justify-content: center; /* Горизонтальное выравнивание */
    margin-bottom: 20px;
    padding: 10px 20px;
    color: #FFF;
    border: 1px solid #FFF;
    border-radius: 5px;
    text-decoration: none;
    background-color: rgba(255, 255, 255, 0.1);
    transition: background-color 0.3s, color 0.3s;
}

.back-button img {
    margin-right: 10px !important; /* Принудительно применяет отступ */
}

        .back-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Заголовок */
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 20px;
            border-bottom: 2px solid #FFF;
            padding-bottom: 10px;
        }

        h2 {
            font-size: 1.8em;
            margin-top: 20px;
            margin-bottom: 15px;
        }

         /* Текстовые блоки */
        p {
            margin: 15px 0;
            line-height: 1.6;
        }

        /* Стили для списков */
        ul {
            list-style: none;
            padding-left: 0;
        }
ul li {
    position: relative;
    padding-left: 24px;
    margin-bottom: 10px;
}

ul li:before {
    content: '';
    display: inline-block; /* Обеспечивает, что иконка будет на одном уровне с текстом */
    position: relative;
    width: 16px;
    height: 16px;
    background-image: url('pack_icon_punkt.svg');
    background-size: contain;
    background-repeat: no-repeat;
    margin-right: 8px; /* Расстояние от текста */
}

ul ul li:before {
    background-image: url('pack_icon_punkt_c.svg');
}

.icon {
    margin-right: 8px; /* Отступ между иконкой и текстом */
    vertical-align: middle; /* Центрирование по вертикали относительно текста */
}

        /* Изображения в тексте */
        .float-image {
            width: 400px;
            margin: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }
        .float-right {
            float: right;
            margin-left: 20px;
        }
        .float-left {
            float: left;
            margin-right: 20px;
        }

        /* Кнопки навигации в конце статьи */
         /* Кнопки статей */
        .article-button {
            display: flex;
            align-items: flex-start;
            padding: 20px;
            border: 1px solid #FFF;
            border-radius: 10px;
            margin-bottom: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            transition: background-color 0.3s, box-shadow 0.3s;
            text-decoration: none;
            color: #FFF;
            min-height: 160px;
        }

        .article-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        .article-button img {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            margin-right: 20px;
            flex-shrink: 0; /* Избегает сжатия изображения */
        }

        .article-content {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .article-title {
            font-size: 1.2em;
            margin: 0;
            margin-bottom: 10px;
        }

        .article-description {
            font-size: 0.95em;
            color: #CCC;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3; /* Ограничивает до 2 строк */
            -webkit-box-orient: vertical;
        }

        /* Стили секций */
        .section-title {
            font-size: 2em;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid #FFF;
            padding-bottom: 10px;
        }

        /* Кнопки */
        .btn-outline-secondary {
            border-color: #FFF;
            color: #FFF;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
                .btn-highlighted {
            background-color: #740315;
            color: white;
            box-shadow: 0 0 5px #740315, 0 0 10px #740315, 0 0 15px #740315;
        }

        .btn-outline-secondary:hover {
            background-color: #FFF;
            color: #000;
        }

        .btn-disabled {
            background-color: rgba(51, 51, 51, 0.2);
            color: #888;
            border: 1px solid #888;
            cursor: default;
            pointer-events: none;
        }

        .social-btn {
            color: #FFF;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            border: 1px solid #FFF;
            padding: 8px;
            border-radius: 5px;
            transition: background-color 0.3s, color 0.3s;
            min-width: 200px; /* Минимальная ширина кнопок */
        }

        .social-btn img {
            width: 24px;
            height: 24px;
            margin-right: 8px;
        }

        .social-btn:hover {
            background-color: #FFF;
            color: #000;
        }

        .form-control, .btn-primary {
            margin-top: 10px;
            max-width: 500px;
        }

        .contact-info .row {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .about-text, .about-image {
            flex: 1 1 300px;
            max-width: 500px;
        }

        .about-image img {
            width: 100%;
            border-radius: 15px;
        }

pre {
    overflow-x: auto; /* Добавляет горизонтальный скролл */
    white-space: pre; /* Отключает перенос строк */
    word-wrap: normal; /* Убирает автоматический перенос слов */
    padding: 10px; /* Добавляет внутренние отступы */
    border: 1px solid #ccc; /* Лёгкая рамка вокруг */
    border-radius: 5px; /* Скруглённые углы */
    background-color: #2d2d2d; /* Цвет фона */
    color: #fff; /* Цвет текста */
    max-width: 100%; /* Ограничивает ширину */
    box-sizing: border-box; /* Учитывает отступы в ширине */
}

        /* Подсветка кода */
        .code-container pre[class*="language-"], .code-container code[class*="language-"] {
            font-size: 1em;
            line-height: 1.5;
            background: #2D2D2D;
            color: #FFF;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            overflow-x: auto;
            white-space: pre;
            max-width: 100%;
            box-sizing: border-box;
        }

        @media screen and (max-width: 768px) {
    pre {
        font-size: 0.9em; /* Уменьшаем размер шрифта */
        padding: 10px; /* Уменьшаем отступы */
    }
}
@media screen and (max-width: 768px) {
    body {
        padding: 20px; /* Уменьшаем внутренние отступы */
    }
 /* Адаптация для мобильных устройств */

    h1 {
        font-size: 1.8em; /* Уменьшаем размер заголовка */
        text-align: center;
    }

    .back-button {
        padding: 8px 1px; /* Уменьшаем размер кнопок */
        font-size: 0.9em; /* Уменьшаем шрифт кнопок */
    }

    .float-image {
        max-width: 100%; /* Ограничиваем ширину изображений */
        height: auto; /* Сохраняем пропорции */
        float: none; /* Убираем обтекание */
        margin: 10px 0; /* Добавляем отступы сверху и снизу */
    }

    ul {
        padding-left: 20px; /* Добавляем отступ для списка */
    }

    ul li {
        padding-left: 20px; /* Сохраняем отступ для иконок */
        margin-left: 0; /* Убираем лишние отступы */
        padding-left: 10px; /* Добавляем небольшой отступ */
    }

    pre {
        font-size: 0.9em; /* Уменьшаем размер шрифта */
        overflow-x: auto; /* Добавляем горизонтальный скролл */
        white-space: pre-wrap; /* Разрешаем перенос строк внутри блока */
        word-wrap: break-word; /* Переносим длинные строки */
    }

    .article-button {
        flex-direction: column; /* Размещаем содержимое кнопки вертикально */
        align-items: center; /* Центрируем содержимое */
        text-align: center; /* Выравниваем текст по центру */
        padding: 10px; /* Уменьшаем отступы */
        min-height: auto; /* Убираем минимальную высоту */
    }

    /* Сами кнопки */
    .article-button {
        padding: 8px; /* Уменьшаем внутренние отступы кнопок */
        margin: 5px 0; /* Уменьшаем внешние отступы */
    }

        .article-button img {
        margin-bottom: 5px; /* Уменьшаем отступ снизу у изображения */
    }

    /* Описание статей */
    .article-title {
        margin-bottom: 5px; /* Уменьшаем отступы заголовков */
    }

    .article-description {
        margin-top: 0; /* Убираем верхние отступы у описания */
    }

    .row {
        flex-direction: column; /* Размещаем элементы в одну колонку */
        gap: 5px; /* Уменьшаем расстояние между элементами */
        margin: 0; /* Убираем отступы у ряда */
    }

    .col-md-4 {
        padding: 5px; /* Уменьшаем внутренние отступы у колонок */
    }

    /* Контейнер страницы */
    .container {
        padding: 5px; /* Уменьшаем общий отступ внутри контейнера */
    }

    .code-container pre {
        margin: 5px 0; /* Уменьшаем внешние отступы кода */
        padding: 5px; /* Уменьшаем внутренние отступы */
    }
}
@media screen and (max-width: 768px) {
    .back-button {
        font-size: 0.9em; /* Уменьшаем размер текста кнопки */
        padding: 8px 10px; /* Уменьшаем отступы */
        display: block; /* Каждая кнопка на своей строке */
        text-align: center; /* Центрируем текст */
    }
}
@media screen and (max-width: 768px) {
    .article-button {
        flex-direction: column; /* Размещаем содержимое вертикально */
        align-items: center; /* Центрируем содержимое */
        text-align: center; /* Выравниваем текст */
        padding: 20px; /* Уменьшаем внутренние отступы */
        min-height: auto; /* Убираем фиксированную высоту */
    }

    .article-button img {
        width: 60px; /* Уменьшаем размер изображения */
        height: auto; /* Сохраняем пропорции */
        margin-bottom: 0px; /* Добавляем отступ снизу */
    }
}
@media screen and (max-width: 768px) {
    h1 {
        font-size: 1.5em; /* Уменьшаем размер заголовка */
        white-space: pre-wrap; /* Разрешаем перенос строк внутри блока */
    }

    h2 {
        font-size: 1.2em; /* Уменьшаем размер подзаголовка */
        white-space: pre-wrap; /* Разрешаем перенос строк внутри блока */
    }
}
.code-container {
    position: relative;
    max-width: 100%;
}

.scroll-hint {
    display: none; /* Скрываем по умолчанию */
    background-color: rgba(255, 255, 255, 0.1); /* Прозрачный фон */
    color: #fff; /* Белый текст */
    padding: 5px 5px; /* Внутренние отступы */
    border-radius: 5px; /* Скруглённые углы */
    font-size: 0.9em; /* Размер шрифта */
    text-align: center; /* Выравнивание текста по центру */
    margin-top: 10px; /* Отступ сверху */
}

@media screen and (max-width: 768px) {
    .scroll-hint {
        display: block; /* Показываем только на мобильных */
        animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
}

    </style>

</head>
<body>

    <!-- Кнопка возврата -->
    <a href="https://hel-3d.github.io/hel-3d/" class="back-button">Вернуться на основной сайт</a>

    <!-- Заголовок статьи -->
    <h1>Скрипт для нарезки pdf в изображения - convert_pdf_to_images.py</h1>

    <!-- Кнопка скачивания -->
    <a href="https://github.com/hel-3d/hel-3d/raw/master/ресурсы/convert_pdf_to_images.zip" class="back-button">Скачать convert_pdf_to_images</a>

    <!-- Кнопка доната -->
<a href="https://yoomoney.ru/fundraise/17HENGAD7EB.250103" class="back-button">
    Задонатить автору *
    <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <path fill="#ffffff" d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3C4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5C22 5.42 19.58 3 16.5 3m-4.4 15.55l-.1.1l-.1-.1C7.14 14.24 4 11.39 4 8.5C4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5c0 2.89-3.14 5.74-7.9 10.05"/>
    </svg>
</a>


    <!-- Текст статьи -->
    <p>Скрипт был написан для упрощения моей собственной работы. Мне будет приятно, если ваша жизнь станет с ним проще.<p> <p>Буквально в несколько секунд вы можете конвертировать pdf файл в набор изображений сохранив их в выбранную папку или создав папку если её не существует.  Все страницы конвертируются в указанной последовательности. Каждое изображение получает имя в формате [название файла]_page_[номер страницы].[формат]. Для удобства скрипт оснащён графическим интерфейсом.<p> <p>convert_pdf_to_images.py работает с изображениями в форматах: JPG, PNG, TIFF. </p>
    
    <!-- Пример с плавающим изображением -->
    <img src="to_jpg_1.png" alt="Пример изображения" class="float-image float-right">

    <p>Для удобства я написала небольшой интерфейс и к тому же добавила в архив bat файл для быстрого открытия скрипта. Кнопка для скачивания архива скрипта находится выше. В конце статьи для любопытствующих будет представлен сам код.  </p>

    <!-- Список с иконками -->
    <h2>Инструкция по установке и запуску</h2>
<ul>
    <li>Проверьте, установлен ли Python на вашем компьютере:
        <ul>
            <li>Откройте командную строку (Win+R → введите cmd → нажмите Enter).</li>
            <li>Введите команду:</li>
                </li><pre class="language-bash"><code>python --version</code></pre>
            </li>
            <li>Если вывод показывает версию Python, переходите к следующему шагу. Если нет:
                <ul>
                    <li>Установите Python с официального сайта: <a href="https://www.python.org/">python.org</a>.</li>
                    <li>Во время установки отметьте галочку "Add Python to PATH".</li>
                </ul>
            </li>
        </ul>
    </li>
    <li>Установите библиотеки Pillow и PyMuPDF:
    </li>
        <ul>
            <li>В командной строке введите (Для Windows):

                <pre class="language-bash"><code>pip install pymupdf pillow</code></pre></li>
</ul>

    <li>Распакуйте архив.
    </li>
    <li>Запустите скрипт:
        <ul>
            <li>Дважды щёлкните на файл convert_pdf_to_images.bat если у вас Windows.</li>
            <li>Если у вас другая операционная система - запустите convert_pdf_to_images.py через командную строку.
    </li>
    <li>Выберите PDF файл, папку для сохранения и формат изображений в интерфейсе.
    </li>
        <!-- Пример с плавающим изображением -->
    <img src="to_jpg_2.png" alt="Пример изображения" class="float-image">
    <li>Дождитесь завершения конвертации. Все страницы будут сохранены как отдельные изображения в указанной папке.
    </li>
            <!-- Пример с плавающим изображением -->
    <img src="to_jpg_3.png" alt="Пример изображения" class="float-image">
</ul>

<div class="side-border left"></div>
<div class="side-border right"></div>

    <!-- Блок кода с подсветкой -->
    <h2>Оригинал кода</h2>
<pre class="language-python"><code>
import os
import fitz  # PyMuPDF
import tkinter as tk
from tkinter import filedialog, messagebox
from tkinter import ttk  # Для стилизованного OptionMenu
from PIL import Image

def save_image_as_tiff(pix, image_path):
    # Конвертация Pixmap в изображение Pillow
    img = Image.frombytes("RGB", [pix.width, pix.height], pix.samples)
    img.save(image_path, format="TIFF")


def convert_pdf_to_images(pdf_path, output_folder, image_format):
    try:
        pdf_document = fitz.open(pdf_path)
        print(f"Всего страниц: {pdf_document.page_count}")

        for page_num in range(pdf_document.page_count):
            page = pdf_document.load_page(page_num)
            pix = page.get_pixmap()

            # Определяем путь для сохранения
            image_path = os.path.join(
                output_folder,
                f"{os.path.basename(pdf_path)[:-4]}_page_{page_num + 1}.{image_format.lower()}",
            )

            # Если формат TIFF, используем Pillow
            if image_format.lower() == "tiff":
                save_image_as_tiff(pix, image_path)
            else:
                pix.save(image_path)  # Для PNG и JPG

            print(f"Сохранено: {image_path}")
        
        messagebox.showinfo("Успех", f"Изображения сохранены в папке: {output_folder}")
    except Exception as e:
        messagebox.showerror("Ошибка", f"Ошибка при обработке файла {pdf_path}: {e}")

def select_pdf_file():
    pdf_path = filedialog.askopenfilename(
        title="Выберите PDF файл",
        filetypes=[("PDF файлы", "*.pdf")],
    )
    if pdf_path:
        selected_pdf_label.config(text=f"{pdf_path}")  # Полностью заменяем текст
        convert_button.config(state=tk.NORMAL)
        convert_button.pdf_path = pdf_path


def select_output_folder():
    output_folder = filedialog.askdirectory(title="Выберите папку для сохранения")
    if output_folder:
        selected_folder_label.config(text=f"{output_folder}")  # Полностью заменяем текст
        convert_button.output_folder = output_folder

def start_conversion():
    pdf_path = getattr(convert_button, "pdf_path", None)
    output_folder = getattr(convert_button, "output_folder", None)
    image_format = format_var.get()

    if not pdf_path or not output_folder:
        messagebox.showerror("Ошибка", "Пожалуйста, выберите PDF файл и папку для сохранения.")
        return

    convert_pdf_to_images(pdf_path, output_folder, image_format)


# Создание главного окна
root = tk.Tk()
root.title("PDF в Изображения")
root.geometry("500x250")
root.configure(bg="#2e2e2e")

# Тёмная тема
label_fg = "#ffffff"
button_bg = "#444444"
button_fg = "#ffffff"
button_width = 17  # Фиксированная ширина для всех кнопок

# Выбор PDF файла (строка 1)
frame_pdf_button = tk.Frame(root, bg="#2e2e2e")
frame_pdf_button.pack(pady=5, fill="x")

pdf_file_label = tk.Label(frame_pdf_button, text="Выберите PDF файл", fg=label_fg, bg="#2e2e2e", font=("Arial", 12), anchor="w")
pdf_file_label.pack(side="left", padx=10)

select_pdf_button = tk.Button(frame_pdf_button, text="Выбрать PDF", command=select_pdf_file, bg=button_bg, fg=button_fg, width=button_width)
select_pdf_button.pack(side="right", padx=10)

# Отображение выбранного файла на отдельной строке
frame_pdf_path = tk.Frame(root, bg="#2e2e2e")
frame_pdf_path.pack(pady=(0, 10), fill="x")

selected_pdf_label = tk.Label(frame_pdf_path, text="", fg=label_fg, bg="#2e2e2e", font=("Arial", 8), anchor="w", wraplength=480)
selected_pdf_label.pack(fill="x", padx=10)

# Выбор папки для сохранения (строка 2)
frame_folder_button = tk.Frame(root, bg="#2e2e2e")
frame_folder_button.pack(pady=5, fill="x")

output_folder_label = tk.Label(frame_folder_button, text="Выберите папку для сохранения", fg=label_fg, bg="#2e2e2e", font=("Arial", 12), anchor="w")
output_folder_label.pack(side="left", padx=10)

select_folder_button = tk.Button(frame_folder_button, text="Выбрать папку", command=select_output_folder, bg=button_bg, fg=button_fg, width=button_width)
select_folder_button.pack(side="right", padx=10)

# Отображение выбранной папки на отдельной строке
frame_folder_path = tk.Frame(root, bg="#2e2e2e")
frame_folder_path.pack(pady=(0, 10), fill="x")

selected_folder_label = tk.Label(frame_folder_path, text="", fg=label_fg, bg="#2e2e2e", font=("Arial", 8), anchor="w", wraplength=480)
selected_folder_label.pack(fill="x", padx=10)


# Выбор формата изображений (строка 3)
frame_format = tk.Frame(root, bg="#2e2e2e")
frame_format.pack(pady=5, fill="x")

format_label = tk.Label(frame_format, text="Выберите формат изображения:", fg=label_fg, bg="#2e2e2e", font=("Arial", 12), anchor="w")
format_label.pack(side="left", padx=10)

format_var = tk.StringVar(value="JPG")
format_dropdown = ttk.OptionMenu(frame_format, format_var, "JPG", "JPG", "PNG", "TIFF")
format_dropdown.config(width=15)  # Устанавливаем фиксированную ширину
format_dropdown.pack(side="right", padx=14)

# Кнопка конвертации (строка 4)
frame_convert = tk.Frame(root, bg="#2e2e2e")
frame_convert.pack(pady=20, fill="x")

convert_button = tk.Button(
    frame_convert, text="Конвертировать", state=tk.DISABLED, command=start_conversion, bg=button_bg, fg=button_fg, width=button_width
)
convert_button.pack()

root.mainloop()

</code></pre>
    <div class="scroll-hint">
        Листай код туда →
    </div>
</div>

    <!-- Кнопки навигации по другим статьям -->
    <div class="container">
        <h2 class="section-title">Другие статьи по теме</h2>    
        <!-- Кнопка возврата -->
    <a href="https://hel-3d.github.io/hel-3d/" class="back-button">Вернуться на основной сайт</a>
        <div class="row">
            <div class="col-md-4 mb-4">
                <a href="#" class="article-button">
                    <img src="link-to-thumbnail1.jpg" alt="Article 1 Thumbnail">
                    <div class="article-content">
                        <h3 class="article-title">Как выбрать выделенный сервер</h3>
                        <p class="article-description">Как выбрать выделенный сервер.</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a href="#" class="article-button">
                    <img src="link-to-thumbnail2.jpg" alt="Article 2 Thumbnail">
                    <div class="article-content">
                        <h3 class="article-title">Топ 10 лучших хостингов 2024 2</h3>
                        <p class="article-description">Топ 10 лучших хостингов 2024.</p>
                    </div>
                </a>
            </div>
            <div class="col-md-4 mb-4">
                <a href="#" class="article-button">
                    <img src="link-to-thumbnail3.jpg" alt="Article 3 Thumbnail">
                    <div class="article-content">
                        <h3 class="article-title">Статья 3</h3>
                        <p class="article-description">Краткое описание статьи</p>
                    </div>
                </a>
            </div>
        </div>

    <!-- Подключение библиотеки Prism.js для подсветки синтаксиса -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>

</body>
</html>
